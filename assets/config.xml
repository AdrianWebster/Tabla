<PaperBounce3>

	<!-- I guess the use of cm is arbitrary, and it could be inches or whatever, but you 
	have to be consistent across all these parameters. -->

	<App>
	
<!--	This could use a cleanup since we refactored into two windows	-->
		<AutoFullScreenProjector>	1 </AutoFullScreenProjector>
		<DrawCameraImage>			1 </DrawCameraImage>
		<DrawContours>				1 </DrawContours>
		<DrawContoursFilled>		0 </DrawContoursFilled>
		<DrawMouseDebugInfo>		1 </DrawMouseDebugInfo>
		<DrawContourMousePick>		1 </DrawContourMousePick>
		<DrawPolyBoundingRect>		0 </DrawPolyBoundingRect>
		<DrawContourTree>			0 </DrawContourTree>
		<DrawPipeline>				1 </DrawPipeline>
		
		<ConfigWindowMainImageMargin> 32 </ConfigWindowMainImageMargin>
		<ConfigWindowPipelineGutter> 8 </ConfigWindowPipelineGutter>
		<ConfigWindowPipelineWidth> 64 </ConfigWindowPipelineWidth>
		
		<KeyboardStringTimeout>.2</KeyboardStringTimeout>
	</App>

	<RFID>
	<!-- Expects RFID reader to be a USB keyboard that emits digits + a newline char -->
		<tag>
			<id>17317668</id>
			<value>cartridge/BallWorld</value>
		</tag>

		<tag>
			<id>17308708</id>
			<value>cartridge/PongWorld</value>
		</tag>

		<tag>
			<id>17317412</id>
			<value>cartridge/MusicWorld</value>
		</tag>

		<tag>
			<id>17325860</id>
			<value>cartridge/CalibrateWorld</value>
		</tag>
		
	</RFID>


	<!-- Projector <> Camera <> World mapping
			This just gives initial values for user configuration.
			Configuration you do in app is saved and loaded from ~Documents/PaperES/.
		-->
	
	<!-- Defaults for our YCR-OAK office setup -->
	<LightLink>
		<CameraIndex>0</CameraIndex>
		<CaptureSize>640 480</CaptureSize>
		<CaptureCoords>638.961792 311.788391
	18.4234161 392.981323
	-2.9909668 41.035408
	581.611816 9.00953865
	</CaptureCoords>
		<CaptureWorldSpaceCoords>0 0
	126 0
	126 69.5
	0 69.5
	</CaptureWorldSpaceCoords>
		<ProjectorCoords>1228.57959 642.460632
	175.379608 772.453308
	-53.7026215 5.9238472
	1216.71448 -30.7076797
	</ProjectorCoords>
		<ProjectorWorldSpaceCoords>0 0
	121.463959 -0.303260803
	130.19603 75.1454391
	-0.606506348 73.5489044
	</ProjectorWorldSpaceCoords>
		<ProjectorSize>1280 800</ProjectorSize>
		<DistCoeffs>[-1, -4.0226412, 0.0079270257, -0.0037597809, 30.936378]</DistCoeffs>
		<CameraMatrix>[1072.3177, 0, 314.25284;
	 0, 1062.8184, 234.11261;
	 0, 0, 1]</CameraMatrix>
	</LightLink>

	

	<Games>
	
		<BallWorld>
			<!-- cm -->
			<DefaultNumBalls>			40 </DefaultNumBalls>
			<BallDefaultRadius>			.5 </BallDefaultRadius>
			<BallDefaultMaxRadius>		2 </BallDefaultMaxRadius>
			<BallMaxVel>				.2 </BallMaxVel>
			<BallDefaultColor>			C62D41 </BallDefaultColor>

			<!-- cm -->
			<Vision>
				<ContourMinRadius>			1	</ContourMinRadius>
				<ContourMinArea>			1	</ContourMinArea>
				<ContourDPEpsilon>			1	</ContourDPEpsilon>
				<ContourMinWidth>			2	</ContourMinWidth>
			</Vision>

		</BallWorld>

		<PongWorld>
			<!-- cm -->
			<BallDefaultRadius>			2 </BallDefaultRadius>
			<BallDefaultMaxRadius>		2 </BallDefaultMaxRadius>
			<BallMaxVel>				1 </BallMaxVel>
			<BallDefaultColor>			C62D41 </BallDefaultColor>

			<!-- cm -->
			<Vision>
				<ContourMinRadius>			1	</ContourMinRadius>
				<ContourMinArea>			1	</ContourMinArea>
				<ContourDPEpsilon>			1	</ContourDPEpsilon>
				<ContourMinWidth>			2	</ContourMinWidth>
			</Vision>

		</PongWorld>

		<CalibrateWorld>

			<BoardCols>8</BoardCols>
			<BoardRows>8</BoardRows>
			
			<DrawBoard>0</DrawBoard>
			<NumBoardsToSolve>12</NumBoardsToSolve>
			<UniqueBoardDiffThresh>5</UniqueBoardDiffThresh>
			<MinSecsBetweenCameraSamples>.5</MinSecsBetweenCameraSamples>
			<Verbose>1</Verbose>
			
			<!-- cm -->
			<Vision>
				<ContourMinRadius>			1	</ContourMinRadius>
				<ContourMinArea>			1	</ContourMinArea>
				<ContourDPEpsilon>			1	</ContourDPEpsilon>
				<ContourMinWidth>			2	</ContourMinWidth>
			</Vision>

		</CalibrateWorld>
		
		
		<MusicWorld>
		
		
				<!-- Vision -->
				
			<!-- General GameWorld Vision settings -->
			<!-- cm -->
			<Vision>
				<ContourMinRadius>			5	</ContourMinRadius>
				<ContourMinArea>			100	</ContourMinArea>
				<ContourDPEpsilon>			5	</ContourDPEpsilon>
				<ContourMinWidth>			12	</ContourMinWidth>
				<CaptureAllPipelineStages>1</CaptureAllPipelineStages> <!-- So we can extract bitmaps -->
			</Vision>

			<!-- Custom MusicVision tuning -->
			<MusicVision>
				<!-- Custom vision settings... Probably shouldn't change unless you know what you are doing!-->
				
				<ScoreNoteVisionThresh>220</ScoreNoteVisionThresh>
				<!-- 0..255, -1 for OTSU (adaptive) -->
				<ScoreVisionTrimFrac>.07</ScoreVisionTrimFrac>
				<!-- When sampling image for each score, what amount to trim the corners (% push towards the center) -->
				<ScoreMaxInteriorAngleDeg>110</ScoreMaxInteriorAngleDeg>

				<!-- Inter-frame score tracking tuning... -->
				<ScoreTrackRejectNumSamples>10</ScoreTrackRejectNumSamples> <!-- How many random samples to try when testing for rejection?-->
				<ScoreTrackRejectSuccessThresh>.2</ScoreTrackRejectSuccessThresh> <!-- What % need to be valid to continue tracking? -->
				<ScoreTrackMaxError>.5</ScoreTrackMaxError> <!-- How much can scores drift between frames to count as the same score? (world space cumulative error (over each corner) -->
				<ScoreTrackTemporalBlendFrac>.7</ScoreTrackTemporalBlendFrac>
					<!-- Only for discrete (MIDI) scores; how much inter-frame temporal blending to do?
						0 for none.
						Numbers in between make sense. :-)
						1 kind of doesn't make sense, since it's 100% old, but might be useful for testing.
					-->
				<ScoreTrackTemporalBlendIfDiffFracLT>.02</ScoreTrackTemporalBlendIfDiffFracLT>
					<!--	Only do temporal blending if frame difference is less than this amount; so fast motion is still fast -->
			</MusicVision>
			

				<!-- Music -->

			<!--	Tempo	-->
			<Tempos>.25 .5 1 1.5 2 4</Tempos>
<!--			<Tempos>.5 1.5 3 6 9 12</Tempos>-->
				<!-- 0 entries means no global tempo, 1 entry means all are fixed.
					 in practice 0 entries--freeform--produces temporally jittery results.-->
			<TempoWorldUnitsPerSecond>5</TempoWorldUnitsPerSecond>
				<!-- how many cm become 1 second? -->

			<TimeVec>1 0</TimeVec> <!-- Vector in world space time moves along -->
			<NoteCount>13</NoteCount>
			<BeatCount>32</BeatCount>
			<NumOctaves>5</NumOctaves> <!-- Number of octaves available for shifting when moving scores in zone along Y -->
			<RootNote>60</RootNote>
			
			<!--	Musical Scales	-->

            <Scales>
				<Scale>
					<Name>Pentatonic</Name>
					<Notes>1 3 6 8 10</Notes>
				</Scale>

				<Scale>
					<Name>Major</Name>
					<Notes>0 2 4 5 7 9</Notes>
				</Scale>

				<Scale>
					<Name>Minor</Name>
					<Notes>0 2 3 5 6 8</Notes>
				</Scale>

				<Scale>
					<Name>Whole Tone</Name>
					<Notes>0 2 4 6 8 10</Notes>
				</Scale>

				<Scale>
					<Name>Chromatic</Name>
					<Notes>0 1 2 3 4 5 6 7 8 9 10 11</Notes>
				</Scale>
			</Scales>

			<!--	Instruments -->
			<Instruments>

				<Instrument>
					<PlayheadColor>00FF00</PlayheadColor>
					<ScoreColor>332288</ScoreColor>
					<NoteOffColor>FFFF00</NoteOffColor>
					<NoteOnColor>00FF00</NoteOnColor>

					<Name>0Volca FM</Name>
					<SynthType>MIDI</SynthType>

					<Port>2</Port>
					<Channel>0</Channel>
					<MapNotesToChannels>0</MapNotesToChannels>
				</Instrument>


				<Instrument>
					<PlayheadColor>00FFFF</PlayheadColor>
					<ScoreColor>993377</ScoreColor>
					<NoteOffColor>00FF00</NoteOffColor>
					<NoteOnColor>FF0000</NoteOnColor>
					
					<Name>1Additive</Name>
					<SynthType>Additive</SynthType>
					
					<Port>0</Port>
					<Channel>0</Channel>
					<MapNotesToChannels>0</MapNotesToChannels>
				</Instrument>

				<Instrument>
					<PlayheadColor>00FF00</PlayheadColor>
					<ScoreColor>112266</ScoreColor>
					<NoteOffColor>FFFF00</NoteOffColor>
					<NoteOnColor>00FF00</NoteOnColor>

					<Name>2Volca Sample</Name>
					<SynthType>MIDI</SynthType>

					<Port>1</Port>
					<Channel>0</Channel>
					<MapNotesToChannels>10</MapNotesToChannels>
				</Instrument>



				<Instrument>
					<PlayheadColor>00FFFF</PlayheadColor>
					<ScoreColor>993377</ScoreColor>
					<NoteOffColor>00FF00</NoteOffColor>
					<NoteOnColor>FF0000</NoteOnColor>

					<Name>3Additive</Name>
					<SynthType>Additive</SynthType>

					<Port>0</Port>
					<Channel>0</Channel>
					<MapNotesToChannels>0</MapNotesToChannels>
				</Instrument>


				<Instrument>
					<PlayheadColor>00FFFF</PlayheadColor>
					<ScoreColor>993377</ScoreColor>
					<NoteOffColor>00FF00</NoteOffColor>
					<NoteOnColor>FF0000</NoteOnColor>

					<Name>4Additive</Name>
					<SynthType>Additive</SynthType>

					<Port>0</Port>
					<Channel>0</Channel>
					<MapNotesToChannels>0</MapNotesToChannels>
				</Instrument>


				<Instrument>
					<PlayheadColor>00FFFF</PlayheadColor>
					<ScoreColor>993377</ScoreColor>
					<NoteOffColor>00FF00</NoteOffColor>
					<NoteOnColor>FF0000</NoteOnColor>

					<Name>5Additive</Name>
					<SynthType>Additive</SynthType>

					<Port>0</Port>
					<Channel>0</Channel>
					<MapNotesToChannels>0</MapNotesToChannels>
				</Instrument>

				<Instrument>
					<PlayheadColor>00FF00</PlayheadColor>
					<ScoreColor>443377</ScoreColor>
					<NoteOffColor>FFFF00</NoteOffColor>
					<NoteOnColor>00FF00</NoteOnColor>

					<Name>6Volca Bass</Name>
					<SynthType>MIDI</SynthType>

					<Port>3</Port>
					<Channel>0</Channel>
					<MapNotesToChannels>0</MapNotesToChannels>
				</Instrument>


				<Instrument>
					<PlayheadColor>00FFFF</PlayheadColor>
					<ScoreColor>993377</ScoreColor>
					<NoteOffColor>00FF00</NoteOffColor>
					<NoteOnColor>FF0000</NoteOnColor>

					<Name>7Additive</Name>
					<SynthType>Additive</SynthType>

					<Port>0</Port>
					<Channel>0</Channel>
					<MapNotesToChannels>0</MapNotesToChannels>
				</Instrument>



				<Instrument>
					<PlayheadColor>00FF00</PlayheadColor>
					<ScoreColor>005566</ScoreColor>
					<NoteOffColor>FFFF00</NoteOffColor>
					<NoteOnColor>00FF00</NoteOnColor>
					
					<Name>8Volca Keys</Name>
					<SynthType>MIDI</SynthType>
					
					<Port>0</Port>
					<Channel>0</Channel>
					<MapNotesToChannels>0</MapNotesToChannels>
				</Instrument>

				<!-- Meta Param Instruments -->

				<Instrument>
					<PlayheadColor>00FF00</PlayheadColor>
					<ScoreColor>0066FF</ScoreColor>
					<NoteOffColor>FFFF00</NoteOffColor>
					<NoteOnColor>00FF00</NoteOnColor>
					
					<Name>Scale</Name>
					<SynthType>Meta</SynthType>
					<MetaParam>Scale</MetaParam>
				</Instrument>

				<Instrument>
					<PlayheadColor>00FF00</PlayheadColor>
					<ScoreColor>CC2211</ScoreColor>
					<NoteOffColor>FFFF00</NoteOffColor>
					<NoteOnColor>00FF00</NoteOnColor>
					
					<Name>RootNote</Name>
					<SynthType>Meta</SynthType>
					<MetaParam>RootNote</MetaParam>
				</Instrument>
				
				<Instrument>
					<PlayheadColor>00FF00</PlayheadColor>
					<ScoreColor>66FF33</ScoreColor>
					<NoteOffColor>FFFF00</NoteOffColor>
					<NoteOnColor>00FF00</NoteOnColor>
					
					<Name>Tempo</Name>
					<SynthType>Meta</SynthType>
					<MetaParam>Tempo</MetaParam>
				</Instrument>
				
			</Instruments>

		</MusicWorld>

	</Games>

</PaperBounce3>
